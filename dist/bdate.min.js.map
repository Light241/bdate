{"version":3,"sources":["bdate.js"],"names":["angular","module","directive","restrict","replace","templateUrl","scope","source","link","popup","isOpen","togglePopup","bdateUtils","isHidden","messages","format","today","date","year","month","day","day_of_week","years",2015,5,"days_total","start_day",6,7,8,9,"invalidParams","errorOnChangeMOnthOrYear","data","dateModel","setDateModel","console","error","setSource","dateSource","setFormat","viewedDate","setViewedDate","yearNum","monthNum","first","Object","keys","last","length","number","count","daysTotal","startDay","name","getMonthName","daysOfWeek","get","getShorts","getDaysOfWeekShorts","setToday","getDaysArr","monthObj","arr","daysCount","daysInWeek","i","j","Array","apply","map","Number","call","shift","unshift","Math","floor","push","isYearExistInSource","getFirstYearInSource","isMonthExistInSource","isFirstMonthInSource","isLastMonthInSource","getFirstMonthInSource","isCanGoNextMonth","isForward","isChangeYear","nextMonth","nextYearNum","result","getLastMonthInSource","goNextMonth","nextObj","init","firstYear","factory","exports","short","isJanuary","isDecember"],"mappings":"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","file":"bdate.min.js","sourcesContent":["angular.module('bdate.datepicker', ['bdate.popup']).directive('bdatepicker', function() {\n  return {\n    restrict: 'E',\n    replace: true,\n    templateUrl: '../dist/templates/default.html',\n    scope: {\n      source: '='\n    },\n    link: function(scope) {\n      scope.popup = {\n        isOpen: false\n      };\n      return scope.togglePopup = function() {\n        return scope.popup.isOpen = !scope.popup.isOpen;\n      };\n    }\n  };\n});\n\nangular.module('bdate', ['bdate.datepicker']);\n\nangular.module('bdate.popup', ['bdate.utils']).directive('bdatePopup', ['bdateUtils', function(bdateUtils) {\n  return {\n    restrict: 'E',\n    replace: true,\n    templateUrl: '../dist/templates/popup.html',\n    scope: {\n      isHidden: '='\n    },\n    link: function(scope) {\n      var messages, source;\n      source = {\n        format: 'dd-mm-yyyy',\n        today: {\n          date: 1432537266825,\n          year: 2015,\n          month: 5,\n          day: 25,\n          day_of_week: 1\n        },\n        years: {\n          2015: {\n            5: {\n              days_total: 31,\n              start_day: 4\n            },\n            6: {\n              days_total: 28,\n              start_day: 7\n            },\n            7: {\n              days_total: 31,\n              start_day: 7\n            },\n            8: {\n              days_total: 30,\n              start_day: 3\n            },\n            9: {\n              days_total: 31,\n              start_day: 5\n            }\n          }\n        }\n      };\n      messages = {\n        invalidParams: 'Invalid params',\n        errorOnChangeMOnthOrYear: 'cannot change month or year'\n      };\n      scope.data = {\n        dateModel: null,\n        setDateModel: function(dateModel) {\n          if (!dateModel) {\n            return console.error(messages.invalidParams);\n          }\n          return scope.data.dateModel = dateModel;\n        },\n        source: null,\n        setSource: function(dateSource) {\n          if (!dateSource) {\n            return console.error(messages.invalidParams);\n          }\n          return scope.data.source = dateSource;\n        },\n        format: null,\n        setFormat: function(format) {\n          if (!format) {\n            return console.error(messages.invalidParams);\n          }\n          return scope.data.format = format;\n        },\n        viewedDate: null,\n        setViewedDate: function(yearNum, monthNum) {\n          if (!yearNum || !monthNum) {\n            return console.error(messages.invalidParams);\n          }\n          yearNum = +yearNum;\n          monthNum = +monthNum;\n          return scope.data.viewedDate = {\n            year: {\n              first: Object.keys(scope.data.source.years)[0],\n              last: Object.keys(scope.data.source.years)[Object.keys(scope.data.source.years).length - 1],\n              number: yearNum,\n              count: Object.keys(scope.data.source.years).length\n            },\n            month: {\n              daysTotal: scope.data.source.years[yearNum][monthNum].days_total,\n              startDay: scope.data.source.years[yearNum][monthNum].start_day,\n              number: monthNum,\n              name: bdateUtils.getMonthName(monthNum),\n              count: Object.keys(scope.data.source.years[yearNum]).length\n            }\n          };\n        },\n        daysOfWeek: {\n          get: function() {\n            return bdateUtils.daysOfWeek;\n          },\n          getShorts: function() {\n            return bdateUtils.getDaysOfWeekShorts();\n          }\n        },\n        today: null,\n        setToday: function(today) {\n          if (!today) {\n            return console.error(messages.invalidParams);\n          }\n          return scope.data.today = today;\n        },\n        getDaysArr: function(monthObj) {\n          var arr, daysCount, daysInWeek, i, j, startDay;\n          daysCount = monthObj.daysTotal;\n          startDay = monthObj.startDay;\n          arr = Array.apply(null, {\n            length: daysCount + 1\n          }).map(Number.call, Number);\n          arr.shift();\n          i = 1;\n          while (i <= startDay - 1) {\n            arr.unshift('');\n            i++;\n          }\n          daysInWeek = 7;\n          if ((arr.length / daysInWeek) === Math.floor(arr.length / daysInWeek)) {\n            return arr;\n          }\n          j = daysCount;\n          while (j <= daysCount + startDay - 1) {\n            arr.push('');\n            j++;\n          }\n          return arr;\n        },\n        isYearExistInSource: function(yearNum) {\n          if (!yearNum) {\n            return console.error(messages.invalidParams);\n          }\n          yearNum = +yearNum;\n          return !!scope.data.source.years[yearNum];\n        },\n        getFirstYearInSource: function() {\n          return Object.keys(scope.data.source.years)[0];\n        },\n        isMonthExistInSource: function(monthNum, yearNum) {\n          if (!yearNum || !monthNum) {\n            return console.error(messages.invalidParams);\n          }\n          yearNum = +yearNum;\n          monthNum = +monthNum;\n          if (!scope.data.source.years[yearNum]) {\n            return false;\n          }\n          return !!scope.data.source.years[yearNum][monthNum];\n        },\n        isFirstMonthInSource: function(yearNum, monthNum) {\n          yearNum = +yearNum;\n          monthNum = +monthNum;\n          return monthNum === Object.keys(scope.data.source.years[yearNum])[0];\n        },\n        isLastMonthInSource: function(yearNum, monthNum) {\n          yearNum = +yearNum;\n          monthNum = +monthNum;\n          return monthNum === Object.keys(scope.data.source.years[yearNum])[Object.keys(scope.data.source.years[yearNum]).length - 1];\n        },\n        getFirstMonthInSource: function(yearNum) {\n          return Object.keys(scope.data.source.years[+yearNum])[0];\n        },\n        isCanGoNextMonth: function(isForward, monthNum, yearNum) {\n          var isChangeYear, isFirstMonthInSource, isLastMonthInSource, nextMonth, nextYearNum, result;\n          yearNum = +yearNum;\n          monthNum = +monthNum;\n          isFirstMonthInSource = scope.data.isFirstMonthInSource(yearNum, monthNum);\n          isLastMonthInSource = scope.data.isLastMonthInSource(yearNum, monthNum);\n          isChangeYear = false;\n          nextYearNum = yearNum;\n          nextMonth = monthNum;\n          if (isForward) {\n            if (!isLastMonthInSource) {\n              nextMonth = monthNum + 1;\n            } else {\n              isChangeYear = true;\n              nextYearNum = yearNum + 1;\n              if (scope.data.isYearExistInSource(nextYearNum)) {\n                nextMonth = scope.data.getFirstMonthInSource(nextYearNum);\n              } else {\n                console.error(messages.errorOnChangeMOnthOrYear);\n                return false;\n              }\n            }\n          } else if (!isForward) {\n            if (!isFirstMonthInSource) {\n              nextMonth = monthNum - 1;\n            } else {\n              isChangeYear = true;\n              nextYearNum = yearNum - 1;\n              if (scope.data.isYearExistInSource(nextYearNum)) {\n                nextMonth = scope.data.getLastMonthInSource(nextYearNum);\n              } else {\n                console.error(messages.errorOnChangeMOnthOrYear);\n                return false;\n              }\n            }\n          }\n          return result = {\n            year: nextYearNum,\n            month: nextMonth\n          };\n        },\n        goNextMonth: function(isForward) {\n          var nextObj;\n          nextObj = scope.data.isCanGoNextMonth(isForward, scope.data.viewedDate.month.number, scope.data.viewedDate.year.number);\n          if (nextObj) {\n            return scope.data.setViewedDate(nextObj.year, nextObj.month);\n          }\n        },\n        init: function(dateSource) {\n          var firstYear;\n          scope.data.setSource(dateSource);\n          scope.data.setFormat(dateSource.format);\n          scope.data.setToday(dateSource.today);\n          if (scope.data.isMonthExistInSource(dateSource.today.year, dateSource.today.month)) {\n            return scope.data.setViewedDate(dateSource.today.year, dateSource.today.month);\n          } else {\n            firstYear = scope.data.getFirstYearInSource();\n            return scope.data.setViewedDate(firstYear, scope.data.getFirstMonthInSource(firstYear));\n          }\n        }\n      };\n      return (function() {\n        return scope.data.init(source);\n      })();\n    }\n  };\n}]);\n\nangular.module('bdate.utils', []).factory('bdateUtils', function() {\n  var daysOfWeek, exports, month;\n  daysOfWeek = [\n    {\n      name: 'Понедельник',\n      short: 'Пн'\n    }, {\n      name: 'Вторник',\n      short: 'Вт'\n    }, {\n      name: 'Среда',\n      short: 'Ср'\n    }, {\n      name: 'Четверг',\n      short: 'Чт'\n    }, {\n      name: 'Пятница',\n      short: 'Пт'\n    }, {\n      name: 'Суббота',\n      short: 'Сб'\n    }, {\n      name: 'Воскресенье',\n      short: 'Вс'\n    }\n  ];\n  month = [\n    {\n      name: 'Январь',\n      short: 'Янв'\n    }, {\n      name: 'Февраль',\n      short: 'Фев'\n    }, {\n      name: 'Март',\n      short: 'Март'\n    }, {\n      name: 'Апрель',\n      short: 'Май'\n    }, {\n      name: 'Май',\n      short: 'Май'\n    }, {\n      name: 'Июнь',\n      short: 'Июнь'\n    }, {\n      name: 'Июль',\n      short: 'Июль'\n    }, {\n      name: 'Август',\n      short: 'Авг'\n    }, {\n      name: 'Сентябрь',\n      short: 'Сент'\n    }, {\n      name: 'Октябрь',\n      short: 'Окт'\n    }, {\n      name: 'Ноябрь',\n      short: 'Ноя'\n    }, {\n      name: 'Декабрь',\n      short: 'Дек'\n    }\n  ];\n  return exports = {\n    daysOfWeek: daysOfWeek,\n    month: month,\n    getDaysOfWeekShorts: function() {\n      var i, result;\n      i = 0;\n      result = [];\n      while (i < daysOfWeek.length) {\n        result.push(daysOfWeek[i].short);\n        i++;\n      }\n      return result;\n    },\n    getMonthName: function(number) {\n      return month[number].name;\n    },\n    isJanuary: function(monthNum) {\n      return monthNum === 1;\n    },\n    isDecember: function(monthNum) {\n      return monthNum === 12;\n    }\n  };\n});\n"],"sourceRoot":"/source/"}